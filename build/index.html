<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <style>
            table { border-collapse: collapse }
            th, td {
                border: 1px solid black;
                padding: 5px;
            }
        </style>
    </head>
    <body>
        <h1>asm.js / WebAssembly examples</h1>
        <form action="" method="post" onsubmit="return false;">
            Find prime numbers between 2 and <input min="2" type="number" id="nb" value="300000"/><button onClick="run(); return false;">Run</button>
        </form>
        <br />
        <table id="results">
            <thead>
                <tr>
                    <th>Number</th>
                    <th>Plain old Javascript</th>
                    <th>asm.js</th>
                    <th>WebAssembly</th>
                </tr>
            </thead>
        </table>
        </div>
        <script type="text/javascript">
            if (!window.Worker) alert('Your browser does not support Web Workers.')

            var table = document.getElementById("results")

            function run() {
                var worker1 =  new Worker('worker.js')
                var nb = document.getElementById("nb").value;

                var tr = document.createElement('tr')
                var nbTD = document.createElement('td')
                var plainTD = document.createElement('td')
                var asmTD = document.createElement('td')
                var wasmTD = document.createElement('td')

                nbTD.innerHTML = nb
                tr.appendChild(nbTD)

                var tds = [plainTD,asmTD,wasmTD]
                tds.forEach((curr) => {
                    curr.innerHTML = 'Running...'
                    tr.appendChild(curr)
                })

                table.appendChild(tr);

                if (window.Worker) {
                    worker1.postMessage([nb])
                    worker1.onmessage = (e) => {
                        tds.forEach((curr, index) => {
                            if (e.data[index]) curr.innerHTML = e.data[index].timeTaken + ' ms'
                        })
                    }
                }
                else alert('Your browser does not support Web Workers.')
            }
        </script>
    </body>
</html>
